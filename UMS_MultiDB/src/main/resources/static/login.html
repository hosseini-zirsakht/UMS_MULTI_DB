
<!--<!DOCTYPE html>-->
<!--<html lang="fa" dir="rtl">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>ورود به سیستم</title>-->
<!--    <style>-->
<!--        * {-->
<!--            margin: 0;-->
<!--            padding: 0;-->
<!--            box-sizing: border-box;-->
<!--            font-family: 'Vazirmatn', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;-->
<!--        }-->

<!--        body {-->
<!--            background: linear-gradient(135deg, #6a11cb, #2575fc);-->
<!--            color: #fff;-->
<!--            display: flex;-->
<!--            justify-content: center;-->
<!--            align-items: center;-->
<!--            min-height: 100vh;-->
<!--            padding: 20px;-->
<!--        }-->

<!--        .container {-->
<!--            background: rgba(255, 255, 255, 0.1);-->
<!--            backdrop-filter: blur(12px);-->
<!--            -webkit-backdrop-filter: blur(12px);-->
<!--            border-radius: 20px;-->
<!--            padding: 30px;-->
<!--            width: 100%;-->
<!--            max-width: 400px;-->
<!--            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);-->
<!--            border: 1px solid rgba(255, 255, 255, 0.18);-->
<!--            animation: fadeIn 0.8s ease-out;-->
<!--        }-->

<!--        h1 {-->
<!--            text-align: center;-->
<!--            margin-bottom: 30px;-->
<!--            font-size: 24px;-->
<!--            font-weight: 700;-->
<!--            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);-->
<!--        }-->

<!--        .form-group {-->
<!--            margin-bottom: 20px;-->
<!--            position: relative;-->
<!--        }-->

<!--        label {-->
<!--            display: block;-->
<!--            margin-bottom: 8px;-->
<!--            font-weight: 500;-->
<!--            color: rgba(255, 255, 255, 0.9);-->
<!--        }-->

<!--        input {-->
<!--            width: 100%;-->
<!--            padding: 12px 15px;-->
<!--            border: none;-->
<!--            border-radius: 10px;-->
<!--            font-size: 15px;-->
<!--            background: rgba(255, 255, 255, 0.15);-->
<!--            color: #fff;-->
<!--            outline: none;-->
<!--            transition: all 0.3s ease;-->
<!--            border: 1px solid rgba(255, 255, 255, 0.1);-->
<!--        }-->

<!--        input::placeholder {-->
<!--            color: rgba(255, 255, 255, 0.6);-->
<!--        }-->

<!--        input:focus {-->
<!--            background: rgba(255, 255, 255, 0.25);-->
<!--            border-color: rgba(255, 255, 255, 0.3);-->
<!--            box-shadow: 0 0 0 3px rgba(37, 117, 252, 0.3);-->
<!--        }-->

<!--        .error-message {-->
<!--            color: #ff6b6b;-->
<!--            font-size: 13px;-->
<!--            margin-bottom: 5px;-->
<!--            min-height: 18px;-->
<!--            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);-->
<!--            animation: fadeIn 0.3s ease-out;-->
<!--        }-->

<!--        .error-input {-->
<!--            border: 1px solid #ff6b6b !important;-->
<!--            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.2) !important;-->
<!--        }-->

<!--        .server-error {-->
<!--            background: rgba(255, 107, 107, 0.2);-->
<!--            padding: 15px;-->
<!--            border-radius: 10px;-->
<!--            margin-bottom: 20px;-->
<!--            text-align: center;-->
<!--            border: 1px solid rgba(255, 107, 107, 0.3);-->
<!--            display: none;-->
<!--        }-->

<!--        @keyframes fadeIn {-->
<!--            from {-->
<!--                opacity: 0;-->
<!--                transform: translateY(-20px);-->
<!--            }-->
<!--            to {-->
<!--                opacity: 1;-->
<!--                transform: translateY(0);-->
<!--            }-->
<!--        }-->

<!--        .buttons {-->
<!--            display: flex;-->
<!--            gap: 10px;-->
<!--            margin-top: 20px;-->
<!--        }-->

<!--        button {-->
<!--            padding: 12px;-->
<!--            border: none;-->
<!--            border-radius: 10px;-->
<!--            font-weight: 600;-->
<!--            cursor: pointer;-->
<!--            transition: all 0.3s ease;-->
<!--            flex: 1;-->
<!--            font-size: 15px;-->
<!--        }-->

<!--        .btn-primary {-->
<!--            background: linear-gradient(to right, #2575fc, #6a11cb);-->
<!--            color: white;-->
<!--            box-shadow: 0 4px 15px rgba(37, 117, 252, 0.3);-->
<!--        }-->

<!--        .btn-primary:hover {-->
<!--            transform: translateY(-2px);-->
<!--            box-shadow: 0 6px 20px rgba(37, 117, 252, 0.4);-->
<!--        }-->

<!--        .btn-secondary {-->
<!--            background: rgba(255, 255, 255, 0.2);-->
<!--            color: #fff;-->
<!--        }-->

<!--        .btn-secondary:hover {-->
<!--            background: rgba(255, 255, 255, 0.3);-->
<!--            transform: translateY(-2px);-->
<!--        }-->

<!--        .forgot-password {-->
<!--            text-align: left;-->
<!--            margin-top: 10px;-->
<!--        }-->

<!--        .forgot-password a {-->
<!--            color: rgba(255, 255, 255, 0.7);-->
<!--            text-decoration: none;-->
<!--            font-size: 13px;-->
<!--            transition: color 0.3s ease;-->
<!--        }-->

<!--        .forgot-password a:hover {-->
<!--            color: #fff;-->
<!--            text-decoration: underline;-->
<!--        }-->
<!--    </style>-->
<!--    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/fonts.css" rel="stylesheet">-->
<!--</head>-->
<!--<body>-->
<!--<div class="container">-->
<!--    <div class="server-error" id="serverError"></div>-->
<!--    <h1>ورود به حساب کاربری</h1>-->
<!--    <form id="loginForm">-->
<!--        <div class="form-group">-->
<!--            <label for="username">نام کاربری یا ایمیل:</label>-->
<!--            <div class="error-message" id="usernameError"></div>-->
<!--            <input type="text" id="username" name="username" placeholder="نام کاربری یا ایمیل خود را وارد کنید">-->
<!--        </div>-->
<!--        <div class="form-group">-->
<!--            <label for="password">رمز عبور:</label>-->
<!--            <div class="error-message" id="passwordError"></div>-->
<!--            <input type="password" id="password" name="password" placeholder="رمز عبور خود را وارد کنید">-->
<!--        </div>-->
<!--        <div class="forgot-password">-->
<!--            <a href="#" id="forgot-password">رمز عبور را فراموش کرده‌اید؟</a>-->
<!--        </div>-->
<!--        <div class="buttons">-->
<!--            <button type="submit" class="btn-primary">ورود</button>-->
<!--            <button type="button" class="btn-secondary" id="go-to-register">ثبت نام</button>-->
<!--        </div>-->
<!--    </form>-->
<!--</div>-->

<!--<script>-->
<!--    document.addEventListener('DOMContentLoaded', function() {-->
<!--        const form = document.getElementById('loginForm');-->
<!--        const serverError = document.getElementById('serverError');-->

<!--        // بررسی اگر کاربر قبلاً وارد شده باشد-->
<!--        if (localStorage.getItem('jwtToken')) {-->
<!--            window.location.href = 'profile.html';-->
<!--        }-->

<!--        form.addEventListener('submit', async function(event) {-->
<!--            event.preventDefault();-->

<!--            // Reset errors-->
<!--            document.querySelectorAll('.error-message').forEach(el => el.textContent = '');-->
<!--            serverError.style.display = 'none';-->

<!--            const username = document.getElementById('username').value.trim();-->
<!--            const password = document.getElementById('password').value.trim();-->

<!--            // اعتبارسنجی ورودی‌ها-->
<!--            if (!username) {-->
<!--                document.getElementById('usernameError').textContent = 'نام کاربری الزامی است';-->
<!--                return;-->
<!--            }-->
<!--            if (!password) {-->
<!--                document.getElementById('passwordError').textContent = 'رمز عبور الزامی است';-->
<!--                return;-->
<!--            }-->

<!--            try {-->
<!--                const response = await fetch('http://localhost:8080/auth/login', {-->
<!--                    method: 'POST',-->
<!--                    headers: {-->
<!--                        'Content-Type': 'application/json'-->
<!--                    },-->
<!--                    body: JSON.stringify({-->
<!--                        username: username,-->
<!--                        password: password-->
<!--                    })-->
<!--                });-->

<!--                const data = await response.json();-->

<!--                if (!response.ok) {-->
<!--                    throw new Error(data.message || 'خطا در ورود');-->
<!--                }-->

<!--                // ذخیره توکن در localStorage-->
<!--                localStorage.setItem('jwtToken', data.token);-->
<!--                localStorage.setItem('userData', JSON.stringify(data.person));-->

<!--                // انتقال به صفحه پروفایل-->
<!--                window.location.href = 'profile.html';-->

<!--            } catch (error) {-->
<!--                serverError.textContent = error.message;-->
<!--                serverError.style.display = 'block';-->
<!--                console.error('Login error:', error);-->
<!--            }-->
<!--        });-->

<!--        // رفتن به صفحه ثبت نام-->
<!--        document.getElementById('go-to-register').addEventListener('click', () => {-->
<!--            window.location.href = 'register-person.html';-->
<!--        });-->

<!--        // فراموشی رمز عبور-->
<!--        document.getElementById('forgot-password').addEventListener('click', (e) => {-->
<!--            e.preventDefault();-->
<!--            window.location.href = 'reset-password-1.html';-->
<!--        });-->
<!--    });-->
<!--</script>-->
<!--</body>-->
<!--</html>-->


<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ورود به سیستم</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Vazirmatn', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #6a11cb, #2575fc);
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 20px;
            padding: 30px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.18);
            animation: fadeIn 0.8s ease-out;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9);
        }

        input {
            width: 100%;
            padding: 12px 15px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            background: rgba(255, 255, 255, 0.15);
            color: #fff;
            outline: none;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        input:focus {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 0 3px rgba(37, 117, 252, 0.3);
        }

        .error-message {
            color: #ff6b6b;
            font-size: 13px;
            margin-bottom: 5px;
            min-height: 18px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            animation: fadeIn 0.3s ease-out;
        }

        .error-input {
            border: 1px solid #ff6b6b !important;
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.2) !important;
        }

        .server-error {
            background: rgba(255, 107, 107, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            border: 1px solid rgba(255, 107, 107, 0.3);
            display: none;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        button {
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            font-size: 15px;
        }

        .btn-primary {
            background: linear-gradient(to right, #2575fc, #6a11cb);
            color: white;
            box-shadow: 0 4px 15px rgba(37, 117, 252, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(37, 117, 252, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .forgot-password {
            text-align: left;
            margin-top: 10px;
        }

        .forgot-password a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            font-size: 13px;
            transition: color 0.3s ease;
        }

        .forgot-password a:hover {
            color: #fff;
            text-decoration: underline;
        }
    </style>
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/fonts.css" rel="stylesheet">
</head>
<body>
<div class="container">
    <div class="server-error" id="serverError"></div>
    <h1>ورود به حساب کاربری</h1>
    <form id="loginForm">
        <div class="form-group">
            <label for="username">نام کاربری یا ایمیل:</label>
            <div class="error-message" id="usernameError"></div>
            <input type="text" id="username" name="username" placeholder="نام کاربری  را وارد کنید">
        </div>
        <div class="form-group">
            <label for="password">رمز عبور:</label>
            <div class="error-message" id="passwordError"></div>
            <input type="password" id="password" name="password" placeholder="رمز عبور خود را وارد کنید">
        </div>
        <div class="forgot-password">
            <a href="#" id="forgot-password">رمز عبور را فراموش کرده‌اید؟</a>
        </div>
        <div class="buttons">
            <button type="submit" class="btn-primary">ورود</button>
            <button type="button" class="btn-secondary" id="go-to-register">ثبت نام</button>
        </div>
    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('loginForm');
        const serverError = document.getElementById('serverError');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');

        // بررسی اگر کاربر قبلاً وارد شده باشد
        if (localStorage.getItem('jwtToken')) {
            window.location.href = 'profile.html';
        }

        // Regex patterns
        const usernameRegex = /^\w{4,20}$/;
        const passwordRegex = /^(?=.*[a-z0-9])(?=.*[A-Z])(?=.*[!@#$%&*])[a-zA-Z\d!@#$%&*]{6,}$/;

        // اعتبارسنجی بلادرنگ
        usernameInput.addEventListener('input', validateUsername);
        passwordInput.addEventListener('input', validatePassword);

        function validateUsername() {
            const username = usernameInput.value.trim();
            const errorElement = document.getElementById('usernameError');

            if (!username) {
                errorElement.textContent = '';
                return false;
            }

            if (!usernameRegex.test(username)) {
                errorElement.textContent = 'نام کاربری باید بین ۴ تا ۲۰ کاراکتر باشد';
                usernameInput.classList.add('error-input');
                return false;
            }

            errorElement.textContent = '';
            usernameInput.classList.remove('error-input');
            return true;
        }

        function validatePassword() {
            const password = passwordInput.value.trim();
            const errorElement = document.getElementById('passwordError');

            if (!password) {
                errorElement.textContent = '';
                return false;
            }

            if (!passwordRegex.test(password)) {
                errorElement.textContent = 'رمز عبور باید بین ۶ تا ۲۰ کاراکتر  باشد';
                passwordInput.classList.add('error-input');
                return false;
            }

            errorElement.textContent = '';
            passwordInput.classList.remove('error-input');
            return true;
        }

        form.addEventListener('submit', async function(event) {
            event.preventDefault();

            // Reset errors
            document.querySelectorAll('.error-message').forEach(el => el.textContent = '');
            serverError.style.display = 'none';

            const username = usernameInput.value.trim();
            const password = passwordInput.value.trim();

            // اعتبارسنجی با regex
            const isUsernameValid = validateUsername();
            const isPasswordValid = validatePassword();

            if (!isUsernameValid || !isPasswordValid) {
                return;
            }

            try {
                const response = await fetch('http://localhost:8080/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: username,
                        password: password
                    })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || 'خطا در ورود');
                }

                // ذخیره توکن در localStorage
                localStorage.setItem('jwtToken', data.token);
                localStorage.setItem('userData', JSON.stringify(data.person));

                // انتقال به صفحه پروفایل
                window.location.href = 'profile.html';

            } catch (error) {
                serverError.textContent = error.message;
                serverError.style.display = 'block';
                console.error('Login error:', error);
            }
        });

        // رفتن به صفحه ثبت نام
        document.getElementById('go-to-register').addEventListener('click', () => {
            window.location.href = 'register-person.html';
        });

        // فراموشی رمز عبور
        document.getElementById('forgot-password').addEventListener('click', (e) => {
            e.preventDefault();
            window.location.href = 'reset-password-1.html';
        });
    });
</script>
</body>
</html>